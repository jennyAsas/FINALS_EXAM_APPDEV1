<!-- src/app/emergency-call/emergency-call.html -->

@if (isCallActive) {
  <!-- Premium Call Interface -->
  <div class="call-interface">
    <!-- Header with Status -->
    <div class="call-header">
      <button class="back-btn" (click)="endCall()" title="End Call">
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5">
          <polyline points="15 18 9 12 15 6"></polyline>
        </svg>
      </button>
      <div class="call-status-info">
        <h3 class="caller-name">{{ callerName }}</h3>
        <p class="caller-status">{{ callerStatus }}</p>
        <div class="call-timer">
          <span class="timer-value">{{ callDisplayTime }}</span>
        </div>
      </div>
      <div class="header-spacer"></div>
    </div>

    <!-- Caller Profile Section -->
    <div class="caller-profile">
      <div class="caller-image-wrapper">
        <img [src]="callerImage" alt="{{ callerName }}" class="caller-image" />
        <div class="pulse-ring pulse-ring-1"></div>
        <div class="pulse-ring pulse-ring-2"></div>
        <div class="pulse-ring pulse-ring-3"></div>
      </div>
    </div>

    <!-- Call Controls -->
    <div class="call-controls">
      <div class="controls-grid">
        <!-- Mute Button -->
        <button
          class="control-btn"
          [class.active]="isMuted"
          (click)="toggleMute()"
          title="Toggle Mute"
        >
          @if (!isMuted) {
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5">
              <path d="M12 1a3 3 0 0 0-3 3v8a3 3 0 0 0 6 0V4a3 3 0 0 0-3-3z"></path>
              <path d="M19 10v2a7 7 0 0 1-14 0v-2"></path>
              <line x1="12" y1="19" x2="12" y2="23"></line>
              <line x1="8" y1="23" x2="16" y2="23"></line>
            </svg>
          } @else {
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5">
              <line x1="1" y1="1" x2="23" y2="23"></line>
              <path d="M9 9v3a3 3 0 0 0 5.12 2.12M15.5 1.67A7 7 0 0 1 19 19M9 17H5a3 3 0 0 1-3-3V7a3 3 0 0 1 3-3h4"></path>
            </svg>
          }
          <span class="btn-label">Mute</span>
        </button>

        <!-- Keypad Button -->
        <button class="control-btn" (click)="viewContacts()" title="Keypad">
          <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5">
            <rect x="5" y="2" width="14" height="20" rx="2" ry="2"></rect>
            <line x1="9" y1="6" x2="15" y2="6"></line>
            <line x1="9" y1="10" x2="15" y2="10"></line>
            <line x1="9" y1="14" x2="15" y2="14"></line>
            <line x1="9" y1="18" x2="15" y2="18"></line>
          </svg>
          <span class="btn-label">Keypad</span>
        </button>

        <!-- Speaker Button -->
        <button
          class="control-btn"
          [class.active]="isSpeakerOn"
          (click)="toggleSpeaker()"
          title="Toggle Speaker"
        >
          @if (isSpeakerOn) {
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5">
              <polygon points="11 5 6 9 2 9 2 15 6 15 11 19 11 5"></polygon>
              <path d="M15.54 8.46a7 7 0 0 1 0 9.9M20.54 3.46a11 11 0 0 1 0 15.56"></path>
            </svg>
          } @else {
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5">
              <polygon points="11 5 6 9 2 9 2 15 6 15 11 19 11 5"></polygon>
              <line x1="23" y1="9" x2="17" y2="15"></line>
              <line x1="17" y1="9" x2="23" y2="15"></line>
            </svg>
          }
          <span class="btn-label">Speaker</span>
        </button>
      </div>

      <!-- Secondary Controls Row -->
      <div class="secondary-controls">
        <!-- Add Call Button -->
        <button class="secondary-btn" (click)="addCall()" title="Add Call">
          <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5">
            <circle cx="12" cy="12" r="1"></circle>
            <path d="M12 1v6m8-2l-4.24 4.24M1 12h6m-2 8l4.24-4.24M23 12v0m0 0l-6-6m6 6l-6 6M12 19v4"></path>
          </svg>
          <span>+</span>
        </button>

        <!-- Hold Button -->
        <button class="secondary-btn" (click)="holdCall()" title="Hold">
          <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5">
            <circle cx="12" cy="12" r="10"></circle>
            <circle cx="8" cy="12" r="2" fill="currentColor"></circle>
            <circle cx="12" cy="12" r="2" fill="currentColor"></circle>
            <circle cx="16" cy="12" r="2" fill="currentColor"></circle>
          </svg>
          <span>≡</span>
        </button>

        <!-- Contacts Button -->
        <button class="secondary-btn" (click)="viewContacts()" title="Contacts">
          <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5">
            <path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"></path>
            <circle cx="12" cy="7" r="4"></circle>
          </svg>
          <span>≡</span>
        </button>
      </div>
    </div>

    <!-- End Call Button -->
    <div class="end-call-section">
      <button class="end-call-btn" (click)="endCall()" title="End Call">
        <svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24" fill="currentColor">
          <path d="M23.5 12a1.5 1.5 0 1 0-3 0 1.5 1.5 0 0 0 3 0z"></path>
          <path d="M20 17.5c-2.5 0-4.5-2-5.5-3.5-1 1.5-3 3.5-5.5 3.5-3 0-5.5-2.5-5.5-5.5v-6c0-3 2.5-5.5 5.5-5.5 2.5 0 4.5 2 5.5 3.5 1-1.5 3-3.5 5.5-3.5 3 0 5.5 2.5 5.5 5.5v6c0 3-2.5 5.5-5.5 5.5z"></path>
        </svg>
      </button>
      <p class="end-call-text">End Call</p>
    </div>
  </div>
}
