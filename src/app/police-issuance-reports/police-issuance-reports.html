<div class="police-reports-page">
  <!-- Header -->
  <header class="page-header">
    <a routerLink="/" class="back-button" aria-label="Go back to dashboard">
      <svg
        xmlns="http://www.w3.org/2000/svg"
        viewBox="0 0 24 24"
        fill="none"
        stroke="currentColor"
        stroke-width="2"
        stroke-linecap="round"
        stroke-linejoin="round"
      >
        <path d="M19 12H5"></path>
        <polyline points="12 19 5 12 12 5"></polyline>
      </svg>
    </a>
    <div class="header-content">
      <div class="header-icon">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor">
          <path d="M12 1L3 5v6c0 5.55 3.84 10.74 9 12 5.16-1.26 9-6.45 9-12V5l-9-4z" />
        </svg>
      </div>
      <div class="header-text">
        <h1>Police Issuance Reports</h1>
        <p>Official alerts issued by Baguio City authorities</p>
      </div>
    </div>
  </header>

  <!-- Search and Filter Section -->
  <section class="controls-section">
    <div class="search-container">
      <svg
        class="search-icon"
        xmlns="http://www.w3.org/2000/svg"
        viewBox="0 0 24 24"
        fill="none"
        stroke="currentColor"
        stroke-width="2"
      >
        <circle cx="11" cy="11" r="8"></circle>
        <line x1="21" y1="21" x2="16.65" y2="16.65"></line>
      </svg>
      <input
        type="text"
        class="search-input"
        placeholder="Search alerts..."
        [ngModel]="searchQuery | async"
        (ngModelChange)="onSearchChange($event)"
      />
      @if ((searchQuery | async) !== '') {
        <button class="clear-search" (click)="clearSearch()" aria-label="Clear search">
          <svg
            xmlns="http://www.w3.org/2000/svg"
            viewBox="0 0 24 24"
            fill="none"
            stroke="currentColor"
            stroke-width="2"
          >
            <line x1="18" y1="6" x2="6" y2="18"></line>
            <line x1="6" y1="6" x2="18" y2="18"></line>
          </svg>
        </button>
      }
    </div>

    <div class="filter-tabs">
      <button
        class="filter-tab"
        [class.active]="(selectedPriority | async) === 'all'"
        (click)="onPriorityChange('all')"
      >
        All
      </button>
      <button
        class="filter-tab priority-high"
        [class.active]="(selectedPriority | async) === 'high'"
        (click)="onPriorityChange('high')"
      >
        Urgent
      </button>
      <button
        class="filter-tab priority-medium"
        [class.active]="(selectedPriority | async) === 'medium'"
        (click)="onPriorityChange('medium')"
      >
        Important
      </button>
      <button
        class="filter-tab priority-low"
        [class.active]="(selectedPriority | async) === 'low'"
        (click)="onPriorityChange('low')"
      >
        Advisory
      </button>
    </div>
  </section>

  <!-- Reports List -->
  <main class="reports-list">
    @if (filteredReports$ | async; as reports) {
      @if (reports.length === 0) {
        <div class="empty-state">
          <div class="empty-icon">
            <svg
              xmlns="http://www.w3.org/2000/svg"
              viewBox="0 0 24 24"
              fill="none"
              stroke="currentColor"
              stroke-width="1.5"
            >
              <path d="M12 1L3 5v6c0 5.55 3.84 10.74 9 12 5.16-1.26 9-6.45 9-12V5l-9-4z" />
              <line x1="12" y1="8" x2="12" y2="12"></line>
              <line x1="12" y1="16" x2="12.01" y2="16"></line>
            </svg>
          </div>
          <h3>No Police Reports Found</h3>
          <p>There are no official alerts matching your criteria at this time.</p>
        </div>
      } @else {
        @for (report of reports; track report.id) {
          <div
            class="feed-item approved {{ getPriorityClass(report.priority) }}"
            [ngClass]="{ 'no-image': !report.imageUrl }"
          >
            <div class="item-header">
              <span class="status-badge">{{ getPriorityLabel(report.priority) }}</span>
            </div>
            <div class="item-details">
              <div class="report-desc">{{ report.description }}</div>
              <div class="meta-row">
                <span class="location-row">
                  <svg width="16" height="16" fill="none" stroke="currentColor" stroke-width="2">
                    <path d="M21 10c0 7-9 13-9 13s-9-6-9-13a9 9 0 0 1 18 0z"></path>
                    <circle cx="12" cy="10" r="3"></circle>
                  </svg>
                  <span
                    >{{ report.street }}{{ report.barangay ? ', ' + report.barangay : '' }}</span
                  >
                </span>
                <span *ngIf="report.landmark" class="landmark-row">
                  <svg width="14" height="14" fill="none" stroke="currentColor" stroke-width="2">
                    <path
                      d="M3 21h18M9 8h1M9 12h1M9 16h1M14 8h1M14 12h1M14 16h1M5 21V5a2 2 0 0 1 2-2h10a2 2 0 0 1 2 2v16"
                    ></path>
                  </svg>
                  <span>{{ report.landmark }}</span>
                </span>
                <span class="date-row">{{ formatDate(report.createdAt) }}</span>
              </div>
            </div>
            <div *ngIf="report.imageUrl" class="item-image">
              <img [src]="report.imageUrl" alt="Incident" />
            </div>
            <div class="item-footer">
              <a [routerLink]="['/report-detail', report.id]" class="view-details-btn">
                <svg
                  xmlns="http://www.w3.org/2000/svg"
                  viewBox="0 0 24 24"
                  fill="none"
                  stroke="currentColor"
                  stroke-width="2"
                >
                  <line x1="5" y1="12" x2="19" y2="12"></line>
                  <polyline points="12 5 19 12 12 19"></polyline>
                </svg>
              </a>
            </div>
          </div>
        }
      }
    }
  </main>
</div>
